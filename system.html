<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>System class &mdash; SiPMF 1.0 documentation</title>
    
    <link rel="stylesheet" href="_static/sphinxdoc.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '1.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="top" title="SiPMF 1.0 documentation" href="index.html" />
    <link rel="next" title="Window class" href="window.html" />
    <link rel="prev" title="Environment class" href="environment.html" /> 
  </head>
  <body role="document">
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="window.html" title="Window class"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="environment.html" title="Environment class"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">SiPMF 1.0 documentation</a> &raquo;</li> 
      </ul>
    </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h4>Previous topic</h4>
  <p class="topless"><a href="environment.html"
                        title="previous chapter">Environment class</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="window.html"
                        title="next chapter">Window class</a></p>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/system.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="module-system">
<span id="system-class"></span><h1>System class<a class="headerlink" href="#module-system" title="Permalink to this headline">¶</a></h1>
<p><em>Code author: Niklaus Johner &lt;<a class="reference external" href="mailto:niklaus&#46;johner&#37;&#52;&#48;a3&#46;epfl&#46;ch">niklaus<span>&#46;</span>johner<span>&#64;</span>a3<span>&#46;</span>epfl<span>&#46;</span>ch</a>&gt;</em></p>
<p>This module contains the <a class="reference internal" href="#system.System" title="system.System"><code class="xref py py-class docutils literal"><span class="pre">System</span></code></a> object as well as a function to Load a <a class="reference internal" href="#system.System" title="system.System"><code class="xref py py-class docutils literal"><span class="pre">System</span></code></a>
from a file.</p>
<dl class="function">
<dt id="system.LoadSystem">
<code class="descname">LoadSystem</code><span class="sig-paren">(</span><em>filename</em><span class="sig-paren">)</span><a class="headerlink" href="#system.LoadSystem" title="Permalink to this definition">¶</a></dt>
<dd><p>Loads a <a class="reference internal" href="#system.System" title="system.System"><code class="xref py py-class docutils literal"><span class="pre">System</span></code></a> object from a file (using pickle)</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>filename</strong> (<a class="reference external" href="https://docs.python.org/library/functions.html#str" title="(in Python v2.7)"><code class="xref py py-class docutils literal"><span class="pre">str</span></code></a>) &#8211; The path to the file. A &#8221;.pkl&#8221; extension will be added automatically to the filename.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="class">
<dt id="system.System">
<em class="property">class </em><code class="descname">System</code><span class="sig-paren">(</span><em>basedir</em>, <em>cv_list</em>, <em>init_input_fname</em>, <em>run_input_fname</em>, <em>init_job_fname</em>, <em>run_job_fname</em>, <em>data_filename</em>, <em>init_nstep</em>, <em>run_nstep</em>, <em>n_data</em>, <em>max_E</em>, <em>temperature</em>, <em>check_fnames</em><span class="sig-paren">)</span><a class="headerlink" href="#system.System" title="Permalink to this definition">¶</a></dt>
<dd><p>The <a class="reference internal" href="#system.System" title="system.System"><code class="xref py py-class docutils literal"><span class="pre">System</span></code></a> is the top class in the hierarchical description of a PMF calculation
by umbrella sampling (<a class="reference internal" href="#system.System" title="system.System"><code class="xref py py-class docutils literal"><span class="pre">System</span></code></a> contains <code class="xref py py-class docutils literal"><span class="pre">Window</span></code> comprising several <code class="xref py py-class docutils literal"><span class="pre">Phase</span></code>, which each
have one <code class="xref py py-class docutils literal"><span class="pre">Job</span></code>). The corresponding simulations will be carried out in a corresponding hierarchy of directories.
The <a class="reference internal" href="#system.System" title="system.System"><code class="xref py py-class docutils literal"><span class="pre">System</span></code></a> contains all the information about the current status
of the simulations and is therefore the only object needed to restart a SiPMF calculation.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>basedir</strong> (<a class="reference external" href="https://docs.python.org/library/functions.html#str" title="(in Python v2.7)"><code class="xref py py-class docutils literal"><span class="pre">str</span></code></a>) &#8211; The root directory in which the PMF calculation will be performed. Windows and
phases will correspond to subdirectories of <em>basedir</em>.</li>
<li><strong>cv_list</strong> (<code class="xref py py-class docutils literal"><span class="pre">list`(:class:`CollectiveVariable</span></code>)) &#8211; List of the collective variables (CV) used in the umbrella sampling</li>
<li><strong>init_input_fname</strong> (<a class="reference external" href="https://docs.python.org/library/functions.html#str" title="(in Python v2.7)"><code class="xref py py-class docutils literal"><span class="pre">str</span></code></a>) &#8211; <em>basedir/init_input_fname</em> is the MD input file used for initializing new windows.</li>
<li><strong>run_input_fname</strong> (<a class="reference external" href="https://docs.python.org/library/functions.html#str" title="(in Python v2.7)"><code class="xref py py-class docutils literal"><span class="pre">str</span></code></a>) &#8211; <em>basedir/run_input_fname</em> is the MD input file used to sample a window.</li>
<li><strong>init_job_fname</strong> (<a class="reference external" href="https://docs.python.org/library/functions.html#str" title="(in Python v2.7)"><code class="xref py py-class docutils literal"><span class="pre">str</span></code></a>) &#8211; <em>basedir/init_job_fname</em> is the job file used to submit initialization runs to the cluster</li>
<li><strong>run_job_fname</strong> (<a class="reference external" href="https://docs.python.org/library/functions.html#str" title="(in Python v2.7)"><code class="xref py py-class docutils literal"><span class="pre">str</span></code></a>) &#8211; <em>basedir/run_job_fname</em> is the job file used to submit sampling runs to the cluster</li>
<li><strong>data_filename</strong> (<a class="reference external" href="https://docs.python.org/library/functions.html#str" title="(in Python v2.7)"><code class="xref py py-class docutils literal"><span class="pre">str</span></code></a>) &#8211; is the name of the file containing the values of the CVs. One such file should be generated
for each sampling phase of every window by the corresponding job and be found in the corresponding directory.</li>
<li><strong>init_nstep</strong> (<a class="reference external" href="https://docs.python.org/library/functions.html#int" title="(in Python v2.7)"><code class="xref py py-class docutils literal"><span class="pre">int</span></code></a>) &#8211; The number of steps for initialization phases</li>
<li><strong>run_nstep</strong> (<a class="reference external" href="https://docs.python.org/library/functions.html#int" title="(in Python v2.7)"><code class="xref py py-class docutils literal"><span class="pre">int</span></code></a>) &#8211; The number of steps for sampling phases</li>
<li><strong>n_data</strong> (<a class="reference external" href="https://docs.python.org/library/functions.html#int" title="(in Python v2.7)"><code class="xref py py-class docutils literal"><span class="pre">int</span></code></a>) &#8211; The number of data wanted for each window.</li>
<li><strong>max_E</strong> (<a class="reference external" href="https://docs.python.org/library/functions.html#float" title="(in Python v2.7)"><code class="xref py py-class docutils literal"><span class="pre">float</span></code></a>) &#8211; The free energy threshold to decide whether to extend the simulation to neighboring windows or not.</li>
<li><strong>temperature</strong> (<a class="reference external" href="https://docs.python.org/library/functions.html#float" title="(in Python v2.7)"><code class="xref py py-class docutils literal"><span class="pre">float</span></code></a>) &#8211; The temperature at which WHAM is performed.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="system.System.AddWindow">
<code class="descname">AddWindow</code><span class="sig-paren">(</span><em>cv_values</em>, <em>spring_constants</em>, <em>parent_window=None</em><span class="sig-paren">)</span><a class="headerlink" href="#system.System.AddWindow" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a new window to the system</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>cv_values</strong> (<code class="xref py py-class docutils literal"><span class="pre">list`(:class:`float</span></code>)) &#8211; Values of the collective variables for this window</li>
<li><strong>spring_constants</strong> (<code class="xref py py-class docutils literal"><span class="pre">list`(:class:`float</span></code>)) &#8211; Spring constants for the constraining potentials</li>
<li><strong>parent_window</strong> (<code class="xref py py-class docutils literal"><span class="pre">Window</span></code>) &#8211; Window from which the new window should be created</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="system.System.CalculatePMF">
<code class="descname">CalculatePMF</code><span class="sig-paren">(</span><em>environment</em><span class="sig-paren">)</span><a class="headerlink" href="#system.System.CalculatePMF" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the PMF. The function generates the meta file listing all the data files and
their corresponding CV values and spring constants and then calls WHAM.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>environment</strong> (<code class="xref py py-class docutils literal"><span class="pre">Environment</span></code>) &#8211; The environment used to call WHAM</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="system.System.GenerateNewWindows">
<code class="descname">GenerateNewWindows</code><span class="sig-paren">(</span><em>environment</em><span class="sig-paren">)</span><a class="headerlink" href="#system.System.GenerateNewWindows" title="Permalink to this definition">¶</a></dt>
<dd><p>Generates new windows around windows with free energy lower than <em>max_E</em> of the system.
The function first updates the PMF (<em>UpdatePMF</em>) and then goes through all the windows
in the system to decide where to generate new ones. If a new window can be generated from several
windows, the one with lowest free energy will be used as parent.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>environment</strong> (<code class="xref py py-class docutils literal"><span class="pre">Environment</span></code>) &#8211; The environment used to call WHAM</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="system.System.GetPathToInitInputFile">
<code class="descname">GetPathToInitInputFile</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#system.System.GetPathToInitInputFile" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the path to the MD input file used to generate new windows (initialization phase)</p>
</dd></dl>

<dl class="method">
<dt id="system.System.GetPathToRunInputFile">
<code class="descname">GetPathToRunInputFile</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#system.System.GetPathToRunInputFile" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the path to the MD input file used to sample windows (run phase)</p>
</dd></dl>

<dl class="method">
<dt id="system.System.Initialize">
<code class="descname">Initialize</code><span class="sig-paren">(</span><em>cv_values</em>, <em>spring_constants</em>, <em>init_restartdir</em><span class="sig-paren">)</span><a class="headerlink" href="#system.System.Initialize" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate the first window.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>cv_values</strong> (<code class="xref py py-class docutils literal"><span class="pre">list`(:class:`float</span></code>)) &#8211; The values to which the collective variables should be restrained for this window.</li>
<li><strong>spring_constants</strong> (<code class="xref py py-class docutils literal"><span class="pre">list`(:class:`float</span></code>)) &#8211; The spring constants used to restrain the collective variables</li>
<li><strong>init_restartdir</strong> (<a class="reference external" href="https://docs.python.org/library/functions.html#str" title="(in Python v2.7)"><code class="xref py py-class docutils literal"><span class="pre">str</span></code></a>) &#8211; <em>basedir/init_restartdir</em> should point to the directory containing the files 
from which the simulation of the first phase of this window should be restarted.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="system.System.PlotPMF">
<code class="descname">PlotPMF</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#system.System.PlotPMF" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot the PMF.</p>
</dd></dl>

<dl class="method">
<dt id="system.System.ReadPMFFile">
<code class="descname">ReadPMFFile</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#system.System.ReadPMFFile" title="Permalink to this definition">¶</a></dt>
<dd><p>Read the PMF file generated by the <em>CalculatePMF</em> function.</p>
</dd></dl>

<dl class="method">
<dt id="system.System.Save">
<code class="descname">Save</code><span class="sig-paren">(</span><em>filename</em><span class="sig-paren">)</span><a class="headerlink" href="#system.System.Save" title="Permalink to this definition">¶</a></dt>
<dd><p>Save the <a class="reference internal" href="#system.System" title="system.System"><code class="xref py py-class docutils literal"><span class="pre">System</span></code></a> to a file using <em>pickle</em>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>filename</strong> (<a class="reference external" href="https://docs.python.org/library/functions.html#str" title="(in Python v2.7)"><code class="xref py py-class docutils literal"><span class="pre">str</span></code></a>) &#8211; The <a class="reference internal" href="#system.System" title="system.System"><code class="xref py py-class docutils literal"><span class="pre">System</span></code></a> will be saved to <em>basedir/filename.pkl</em></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="system.System.SubmitNewJobs">
<code class="descname">SubmitNewJobs</code><span class="sig-paren">(</span><em>environment</em><span class="sig-paren">)</span><a class="headerlink" href="#system.System.SubmitNewJobs" title="Permalink to this definition">¶</a></dt>
<dd><p>Submit the next series of jobs. This does not create new windows, only go through the
existing windows and submit the next job (initialization or run) for that window if necessary
(if not enough data has been collected yet for that window).</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>environment</strong> &#8211; The environment used to submit the jobs</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="system.System.UpdatePMF">
<code class="descname">UpdatePMF</code><span class="sig-paren">(</span><em>environment</em><span class="sig-paren">)</span><a class="headerlink" href="#system.System.UpdatePMF" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the PMF (<em>CalculatePMF</em>), then reads the ouput PMF file (<em>ReadPMFFile</em>)
and plots the new PMF. Finally, using the PMF, it assigns a free energy value to each window.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>environment</strong> (<code class="xref py py-class docutils literal"><span class="pre">Environment</span></code>) &#8211; The environment used to call WHAM</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="system.System.UpdateUnfinishedJobList">
<code class="descname">UpdateUnfinishedJobList</code><span class="sig-paren">(</span><em>environment</em><span class="sig-paren">)</span><a class="headerlink" href="#system.System.UpdateUnfinishedJobList" title="Permalink to this definition">¶</a></dt>
<dd><p>Check whether running jobs are still in the queue and update 
the list of unfinished jobs and updated windows.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>environment</strong> &#8211; The environment used to check the job status</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

</div>


          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="window.html" title="Window class"
             >next</a> |</li>
        <li class="right" >
          <a href="environment.html" title="Environment class"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">SiPMF 1.0 documentation</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &copy; Copyright 2016, Niklaus Johner.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.3.1.
    </div>
  </body>
</html>